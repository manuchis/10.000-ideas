$(document).ready(function(){ideasmap=Base64.decode(ideasmap);citymap=Base64.decode(citymap);$(".updates-list-filter").buttonset();$(".updates-list").hide();$(".updates-list.active").show();$(".updates-list-filter input").click(function(){$(".updates-list-filter input").attr("checked",false);$(this).attr("checked",true);var h=$(this).val();$(".updates-list.active").removeClass("active").fadeOut("fast",function(){$("#"+h).fadeIn("slow").addClass("active")})});$("#ciudad").dropkick({change:function(j,i){$("#city").val(j);var h="index.php?city="+j;$(location).attr("href",h)}});$("#category").dropkick({width:150,change:function(i,h){$("#category").val(i)}});$("#neighborhood").dropkick({width:150,change:function(i,h){$("#neighborhood").val(i)}});$(".votes-link").click(function(){var k=$(this).children(".votes");var j=k.text();var l=$(this).attr("voteid");var i=$("#user").val();var h=$("#ub").val();if(h==1){alert("Usuario bloqueado, escribenos a 1@000ideas.com")}else{$.ajax({url:"action_vote.php",type:"POST",data:"action=new_vote&usuario="+i+"&votes="+j+"&id="+l,success:function(n){if(n=="650"){alert("Ya votaste, solo puedes votar una vez.")}else{if(n=="651"){alert("Tienes que ingresar como usuario para votar.")}else{if(n=="500"){alert("Error desconocido, intenta más tarde.")}else{var m=parseInt(j)+1;k.text(m);alert("Gracias por votar")}}}}})}return false});var b;var g=new google.maps.LatLng(-34.6166667,-58.44999999999999);var f=new Boolean();var e=new google.maps.Geocoder();var a={zoom:12,scrollwheel:false,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:false,};e.geocode({address:citymap},function(i,h){if(h==google.maps.GeocoderStatus.OK){d.setCenter(i[0].geometry.location)}});var d=new google.maps.Map(document.getElementById("map_canvas"),a);mapa(d,ideasmap);if(hasCity=""){if(navigator.geolocation){f=true;navigator.geolocation.getCurrentPosition(function(h){b=new google.maps.LatLng(h.coords.latitude,h.coords.longitude);d.setCenter(b)},function(){handleNoGeolocation(f)})}else{if(google.gears){f=true;var c=google.gears.factory.create("beta.geolocation");c.getCurrentPosition(function(h){b=new google.maps.LatLng(h.latitude,h.longitude);d.setCenter(b)},function(){handleNoGeoLocation(f)})}else{f=false;handleNoGeolocation(f)}}}});function mapa(a,g){var j=g.split(";");var h=j.length-1;for(var d=0;d<h;d++){var f=j[d].split(",");if(f[4]=="Todos"){var b=f[3]+", "+f[5]+", "+f[6]}else{var b=f[3]+", "+f[4]+", "+f[5]+", "+f[6]}var c=new google.maps.Geocoder();var e={address:b,region:"NO"};c.geocode(e,geoCallback(a,f,h))}}function geoCallback(c,b,a){return function(e,d){if(d==google.maps.GeocoderStatus.OK){addMarker(c,b,e[0].geometry.location);if(a==1){c.setCenter(e[0].geometry.location)}}else{console.log("Geocode failed "+d)}}}function addMarker(e,d,b){var a=new google.maps.Marker({map:e,position:b,icon:"img/cats/"+d[7]+"_m.png"});a.setTitle(d[1]);var c=new google.maps.InfoWindow({content:"<div class='infowindow_class'><strong>"+d[1]+"</strong>En "+d[4]+" <a href=''>Ver idea ></a></div>",size:new google.maps.Size(100,300)});new google.maps.event.addListener(a,"click",function(){c.open(e,a)})}function handleNoGeolocation(a){if(a==true){alert("El servicio de Geolocalización ha fallado, seleccioná la ciudad donde vivís.");initialLocation=baires}else{alert("Tu navegador no soporta el servicio de geolocalización. Por el momento te ubicamos en Buenos Aires, pero puedes elegir tu ciudad desde el selector.");initialLocation=baires}map.setCenter(initialLocation)};